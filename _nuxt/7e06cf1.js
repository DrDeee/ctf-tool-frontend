/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{120:function(e,t,r){"use strict";var o={name:"ClientOnly",functional:!0,props:{placeholder:String,placeholderTag:{type:String,default:"div"}},render:function(e,t){var r=t.parent,o=t.slots,n=t.props,c=o(),h=c.default;void 0===h&&(h=[]);var l=c.placeholder;return r._isMounted?h:(r.$once("hook:mounted",(function(){r.$forceUpdate()})),n.placeholderTag&&(n.placeholder||l)?e(n.placeholderTag,{class:["client-only-placeholder"]},n.placeholder||l):h.length>0?h.map((function(){return e(!1)})):e(!1))}};e.exports=o},123:function(e,t,r){"use strict";function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidCharacterError";var n="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new o("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,i=0,c="";n=t.charAt(i++);~n&&(r=a%4?64*r+n:n,a++%4)?c+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return c};function c(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return n(t)}}function h(e){this.message=e}function l(e,t){if("string"!=typeof e)throw new h("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(c(e.split(".")[r]))}catch(e){throw new h("Invalid token specified: "+e.message)}}h.prototype=new Error,h.prototype.name="InvalidTokenError";const a=l;a.default=l,a.InvalidTokenError=h,e.exports=a},165:function(e,t,r){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},176:function(e,t,r){"use strict";t.a=function(e,t){return t=t||{},new Promise((function(r,o){var s=new XMLHttpRequest,n=[],u=[],i={},a=function(){return{ok:2==(s.status/100|0),statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:a,headers:{keys:function(){return n},entries:function(){return u},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}};for(var c in s.open(t.method||"get",e,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,r){n.push(t=t.toLowerCase()),u.push([t,r]),i[t]=i[t]?i[t]+","+r:r})),r(a())},s.onerror=o,s.withCredentials="include"==t.credentials,t.headers)s.setRequestHeader(c,t.headers[c]);s.send(t.body||null)}))}},178:function(e,t,r){"use strict";var o=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function c(e,t){return!1!==t.clone&&t.isMergeableObject(e)?m((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function h(e,source,t){return e.concat(source).map((function(element){return c(element,t)}))}function l(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(symbol){return e.propertyIsEnumerable(symbol)})):[]}(e))}function d(object,e){try{return e in object}catch(e){return!1}}function f(e,source,t){var r={};return t.isMergeableObject(e)&&l(e).forEach((function(o){r[o]=c(e[o],t)})),l(source).forEach((function(o){(function(e,t){return d(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(d(e,o)&&t.isMergeableObject(source[o])?r[o]=function(e,t){if(!t.customMerge)return m;var r=t.customMerge(e);return"function"==typeof r?r:m}(o,t)(e[o],source[o],t):r[o]=c(source[o],t))})),r}function m(e,source,t){(t=t||{}).arrayMerge=t.arrayMerge||h,t.isMergeableObject=t.isMergeableObject||o,t.cloneUnlessOtherwiseSpecified=c;var r=Array.isArray(source);return r===Array.isArray(e)?r?t.arrayMerge(e,source,t):f(e,source,t):c(source,t)}m.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return m(e,r,t)}),{})};var y=m;e.exports=y},181:function(e,t,r){(function(e){e.installComponents=function(component,e){var r="function"==typeof component.exports?component.exports.extendOptions:component.options;for(var i in"function"==typeof component.exports&&(r.components=component.exports.options.components),r.components=r.components||{},e)r.components[i]=r.components[i]||e[i];r.functional&&function(component,e){if(component.exports[t])return;component.exports[t]=!0;var r=component.exports.render;component.exports.render=function(t,o){return r(t,Object.assign({},o,{_c:function(t,a,b){return o._c(e[t]||t,a,b)}}))}}(component,r.components)};var t="_functionalComponents"}).call(this,r(29))},26:function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var content=function(e,t){var content=e[1]||"",r=e[3];if(!r)return content;if(t&&"function"==typeof btoa){var o=(c=r,h=btoa(unescape(encodeURIComponent(JSON.stringify(c)))),data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(h),"/*# ".concat(data," */")),n=r.sources.map((function(source){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(source," */")}));return[content].concat(n).concat([o]).join("\n")}var c,h,data;return[content].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(content,"}"):content})).join("")},t.i=function(e,r,o){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(o)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(n[c]=!0)}for(var h=0;h<e.length;h++){var l=[].concat(e[h]);o&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},27:function(e,t,r){"use strict";function o(e,t){for(var r=[],o={},i=0;i<t.length;i++){var n=t[i],c=n[0],h={id:e+":"+i,css:n[1],media:n[2],sourceMap:n[3]};o[c]?o[c].parts.push(h):r.push(o[c]={id:c,parts:[h]})}return r}r.r(t),r.d(t,"default",(function(){return x}));var n="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!n)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c={},head=n&&(document.head||document.getElementsByTagName("head")[0]),h=null,l=0,d=!1,f=function(){},m=null,y="data-vue-ssr-id",v="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function x(e,t,r,n){d=r,m=n||{};var h=o(e,t);return k(h),function(t){for(var r=[],i=0;i<h.length;i++){var n=h[i];(l=c[n.id]).refs--,r.push(l)}t?k(h=o(e,t)):h=[];for(i=0;i<r.length;i++){var l;if(0===(l=r[i]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete c[l.id]}}}}function k(e){for(var i=0;i<e.length;i++){var t=e[i],r=c[t.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](t.parts[o]);for(;o<t.parts.length;o++)r.parts.push(S(t.parts[o]));r.parts.length>t.parts.length&&(r.parts.length=t.parts.length)}else{var n=[];for(o=0;o<t.parts.length;o++)n.push(S(t.parts[o]));c[t.id]={id:t.id,refs:1,parts:n}}}}function _(){var e=document.createElement("style");return e.type="text/css",head.appendChild(e),e}function S(e){var t,r,o=document.querySelector("style["+y+'~="'+e.id+'"]');if(o){if(d)return f;o.parentNode.removeChild(o)}if(v){var n=l++;o=h||(h=_()),t=U.bind(null,o,n,!1),r=U.bind(null,o,n,!0)}else o=_(),t=T.bind(null,o),r=function(){o.parentNode.removeChild(o)};return t(e),function(o){if(o){if(o.css===e.css&&o.media===e.media&&o.sourceMap===e.sourceMap)return;t(e=o)}else r()}}var w,$=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function U(e,t,r,o){var n=r?"":o.css;if(e.styleSheet)e.styleSheet.cssText=$(t,n);else{var c=document.createTextNode(n),h=e.childNodes;h[t]&&e.removeChild(h[t]),h.length?e.insertBefore(c,h[t]):e.appendChild(c)}}function T(e,t){var r=t.css,o=t.media,n=t.sourceMap;if(o&&e.setAttribute("media",o),m.ssrId&&e.setAttribute(y,t.id),n&&(r+="\n/*# sourceURL="+n.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}},52:function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return I})),r.d(t,"c",(function(){return W})),r.d(t,"d",(function(){return C}));var o=r(93),n=r(54),c=r(122),h=r(123),l=r(91);const d=e=>null==e,f=e=>!d(e),m=(e,a,b)=>k(a,e)===k(b,e);function y(u){return u&&u.length&&new RegExp(["^\\/([a-zA-Z0-9@\\-%_~.:]","[/a-zA-Z0-9@\\-%_~.:]*)?","([?][^#]*)?(#[^#]*)?$"].join("")).test(u)}function v(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>encodeURIComponent(e)+(null!=t?"="+encodeURIComponent(t):""))).join("&")}function x(e,t,r){return e.matched.some((e=>Object.values(e.components).some((component=>component.options&&component.options[t]===r))))}function k(path="",e){let t=path.split("?")[0];return e&&e.base&&(t=t.replace(e.base,"/")),"/"===t.charAt(t.length-1)&&(t=t.slice(0,-1)),t=t.replace(/\/+/g,"/"),t}function _(e){return"string"==typeof e?e:JSON.stringify(e)}function S(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function w(e,t){if(!t||!e||"object"!=typeof e)return e;if(t in e)return e[t];const r=Array.isArray(t)?t:(t+"").split(".");let o=e;for(;r.length&&o;)o=o[r.shift()];return o}function $(e,t){return e&&t&&"string"==typeof e&&!e.startsWith(t)?t+" "+e:e}function U(...e){return e.join("/").replace(/[/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}const T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function E(e){let t="";const r=T.length;for(let i=0;i<e;i++)t+=T.charAt(Math.floor(Math.random()*r));return t}class R{constructor(e,t){this.ctx=e,this.options=t,this._initState()}setUniversal(e,t){return d(t)?this.removeUniversal(e):(this.setCookie(e,t),this.setLocalStorage(e,t),this.setState(e,t),t)}getUniversal(e){let t;return d(t)&&(t=this.getCookie(e)),d(t)&&(t=this.getLocalStorage(e)),d(t)&&(t=this.getState(e)),t}syncUniversal(e,t){let r=this.getUniversal(e);return d(r)&&f(t)&&(r=t),f(r)&&this.setUniversal(e,r),r}removeUniversal(e){this.removeState(e),this.removeLocalStorage(e),this.removeCookie(e)}_initState(){if(n.set(this,"_state",{}),this._useVuex=this.options.vuex&&!!this.ctx.store,this._useVuex){const e={namespaced:!0,state:()=>this.options.initialState,mutations:{SET(e,t){n.set(e,t.key,t.value)}}};this.ctx.store.registerModule(this.options.vuex.namespace,e,{preserveState:Boolean(this.ctx.store.state[this.options.vuex.namespace])}),this.state=this.ctx.store.state[this.options.vuex.namespace]}else n.set(this,"state",{}),console.warn("[AUTH] The Vuex Store is not activated. This might cause issues in auth module behavior, like redirects not working properly.To activate it, see https://nuxtjs.org/docs/2.x/directory-structure/store")}setState(e,t){return"_"===e[0]?n.set(this._state,e,t):this._useVuex?this.ctx.store.commit(this.options.vuex.namespace+"/SET",{key:e,value:t}):n.set(this.state,e,t),t}getState(e){return"_"!==e[0]?this.state[e]:this._state[e]}watchState(e,t){if(this._useVuex)return this.ctx.store.watch((t=>w(t[this.options.vuex.namespace],e)),t)}removeState(e){this.setState(e,void 0)}setLocalStorage(e,t){if(d(t))return this.removeLocalStorage(e);if("undefined"==typeof localStorage||!this.options.localStorage)return;const r=this.options.localStorage.prefix+e;try{localStorage.setItem(r,_(t))}catch(e){if(!this.options.ignoreExceptions)throw e}return t}getLocalStorage(e){if("undefined"==typeof localStorage||!this.options.localStorage)return;const t=this.options.localStorage.prefix+e;return S(localStorage.getItem(t))}removeLocalStorage(e){if("undefined"==typeof localStorage||!this.options.localStorage)return;const t=this.options.localStorage.prefix+e;localStorage.removeItem(t)}getCookies(){const e=document.cookie;return c.parse(e||"")||{}}setCookie(e,t,r={}){if(!this.options.cookie)return;const o=(void 0!==r.prefix?r.prefix:this.options.cookie.prefix)+e,n=Object.assign({},this.options.cookie.options,r),h=_(t);d(t)&&(n.maxAge=-1),"number"==typeof n.expires&&(n.expires=new Date(Date.now()+864e5*n.expires));const l=c.serialize(o,h,n);return document.cookie=l,t}getCookie(e){if(!this.options.cookie)return;const t=this.options.cookie.prefix+e,r=this.getCookies();return S(r[t]?decodeURIComponent(r[t]):void 0)}removeCookie(e,t){this.setCookie(e,void 0,t)}}class O{constructor(e,t){this.strategies={},this._errorListeners=[],this._redirectListeners=[],this.ctx=e,this.options=t;const r=new R(e,{...t,initialState:{user:null,loggedIn:!1}});this.$storage=r,this.$state=r.state}get state(){return this._stateWarnShown||(this._stateWarnShown=!0,console.warn("[AUTH] $auth.state is deprecated. Please use $auth.$state or top level props like $auth.loggedIn")),this.$state}get strategy(){return this.getStrategy()}getStrategy(e=!0){if(e){if(!this.$state.strategy)throw new Error("No strategy is set!");if(!this.strategies[this.$state.strategy])throw new Error("Strategy not supported: "+this.$state.strategy)}return this.strategies[this.$state.strategy]}get user(){return this.$state.user}get loggedIn(){return this.$state.loggedIn}get busy(){return this.$storage.getState("busy")}async init(){if(this.options.resetOnError&&this.onError(((...e)=>{("function"!=typeof this.options.resetOnError||this.options.resetOnError(...e))&&this.reset()})),this.$storage.syncUniversal("strategy",this.options.defaultStrategy),!this.getStrategy(!1)&&(this.$storage.setUniversal("strategy",this.options.defaultStrategy),!this.getStrategy(!1)))return Promise.resolve();try{await this.mounted()}catch(e){this.callOnError(e)}finally{this.options.watchLoggedIn&&this.$storage.watchState("loggedIn",(e=>{x(this.ctx.route,"auth",!1)||this.redirect(e?"home":"logout")}))}}getState(e){return this._getStateWarnShown||(this._getStateWarnShown=!0,console.warn("[AUTH] $auth.getState is deprecated. Please use $auth.$storage.getState() or top level props like $auth.loggedIn")),this.$storage.getState(e)}registerStrategy(e,t){this.strategies[e]=t}setStrategy(e){if(e===this.$storage.getUniversal("strategy"))return Promise.resolve();if(!this.strategies[e])throw new Error(`Strategy ${e} is not defined!`);return this.reset(),this.$storage.setUniversal("strategy",e),this.mounted()}mounted(...e){return this.getStrategy().mounted?Promise.resolve(this.getStrategy().mounted(...e)).catch((e=>(this.callOnError(e,{method:"mounted"}),Promise.reject(e)))):this.fetchUserOnce()}loginWith(e,...t){return this.setStrategy(e).then((()=>this.login(...t)))}login(...e){return this.getStrategy().login?this.wrapLogin(this.getStrategy().login(...e)).catch((e=>(this.callOnError(e,{method:"login"}),Promise.reject(e)))):Promise.resolve()}fetchUser(...e){return this.getStrategy().fetchUser?Promise.resolve(this.getStrategy().fetchUser(...e)).catch((e=>(this.callOnError(e,{method:"fetchUser"}),Promise.reject(e)))):Promise.resolve()}logout(...e){return this.getStrategy().logout?Promise.resolve(this.getStrategy().logout(...e)).catch((e=>(this.callOnError(e,{method:"logout"}),Promise.reject(e)))):(this.reset(),Promise.resolve())}setUserToken(e,t){return this.getStrategy().setUserToken?Promise.resolve(this.getStrategy().setUserToken(e,t)).catch((e=>(this.callOnError(e,{method:"setUserToken"}),Promise.reject(e)))):(this.getStrategy().token.set(e),Promise.resolve())}reset(...e){return this.getStrategy().reset||(this.setUser(!1),this.getStrategy().token.reset(),this.getStrategy().refreshToken.reset()),this.getStrategy().reset(...e)}refreshTokens(){return this.getStrategy().refreshController?Promise.resolve(this.getStrategy().refreshController.handleRefresh()).catch((e=>(this.callOnError(e,{method:"refreshTokens"}),Promise.reject(e)))):Promise.resolve()}check(...e){return this.getStrategy().check?this.getStrategy().check(...e):{valid:!0}}fetchUserOnce(...e){return this.$state.user?Promise.resolve():this.fetchUser(...e)}setUser(e){this.$storage.setState("user",e);let t={valid:Boolean(e)};t.valid&&(t=this.check()),this.$storage.setState("loggedIn",t.valid)}request(e,t={}){const r="object"==typeof t?Object.assign({},t,e):e;if(""===r.baseURL&&(r.baseURL=o(this.ctx.req)),this.ctx.app.$axios)return this.ctx.app.$axios.request(r).catch((e=>(this.callOnError(e,{method:"request"}),Promise.reject(e))));console.error("[AUTH] add the @nuxtjs/axios module to nuxt.config file")}requestWith(e,t,r){const o=this.getStrategy().token.get(),n=Object.assign({},r,t),c=this.strategies[e].options.token.name||"Authorization";return n.headers||(n.headers={}),!n.headers[c]&&f(o)&&o&&"string"==typeof o&&(n.headers[c]=o),this.request(n)}wrapLogin(e){return this.$storage.setState("busy",!0),this.error=null,Promise.resolve(e).then((e=>(this.$storage.setState("busy",!1),e))).catch((e=>(this.$storage.setState("busy",!1),Promise.reject(e))))}onError(e){this._errorListeners.push(e)}callOnError(e,t={}){this.error=e;for(const r of this._errorListeners)r(e,t)}redirect(e,t=!1){if(!this.options.redirect)return;const r=this.options.fullPathRedirect?this.ctx.route.fullPath:this.ctx.route.path;let o=this.options.redirect[e];if(o){if(this.options.rewriteRedirects&&("login"===e&&y(r)&&!m(this.ctx,o,r)&&this.$storage.setUniversal("redirect",r),"home"===e)){const e=this.$storage.getUniversal("redirect");this.$storage.setUniversal("redirect",null),y(e)&&(o=e)}o=this.callOnRedirect(o,r)||o,m(this.ctx,o,r)||(t?(y(o)&&!o.includes(this.ctx.base)&&(o=k("/"+this.ctx.base+"/"+o)),window.location.replace(o)):this.ctx.redirect(o,this.ctx.query))}}onRedirect(e){this._redirectListeners.push(e)}callOnRedirect(e,t){for(const r of this._redirectListeners)e=r(e,t)||e;return e}hasScope(e){const t=this.$state.user&&w(this.$state.user,this.options.scopeKey);return!!t&&(Array.isArray(t)?t.includes(e):Boolean(w(t,e)))}}const C=async e=>{if(x(e.route,"auth",!1))return;if(!function(e,t=[]){return[].concat(...e.matched.map((function(e,r){return Object.keys(e.components).map((function(o){return t.push(r),e.components[o]}))})))}(e.route,[]).length)return;const{login:t,callback:r}=e.$auth.options.redirect,o=x(e.route,"auth","guest"),n=t=>k(e.route.path,e)===k(t,e);if(e.$auth.$state.loggedIn){const{tokenExpired:r,refreshTokenExpired:c,isRefreshable:h}=e.$auth.check(!0);if((!t||n(t)||o)&&e.$auth.redirect("home"),c)e.$auth.reset();else if(r)if(h)try{await e.$auth.refreshTokens()}catch(t){e.$auth.reset()}else e.$auth.reset()}else o||r&&n(r)||e.$auth.redirect("login")};class I extends Error{constructor(){super("Both token and refresh token have expired. Your request was aborted."),this.name="ExpiredAuthSessionError"}}class P{constructor(e){this.scheme=e,this._refreshPromise=null,this.$auth=e.$auth}handleRefresh(){return this._refreshPromise?this._refreshPromise:this._doRefresh()}_doRefresh(){return this._refreshPromise=new Promise(((e,t)=>{this.scheme.refreshTokens().then((t=>{this._refreshPromise=null,e(t)})).catch((e=>{this._refreshPromise=null,t(e)}))})),this._refreshPromise}}var A,j;(j=A||(A={})).UNKNOWN="UNKNOWN",j.VALID="VALID",j.EXPIRED="EXPIRED";class L{constructor(e,t){this._status=this._calculate(e,t)}unknown(){return A.UNKNOWN===this._status}valid(){return A.VALID===this._status}expired(){return A.EXPIRED===this._status}_calculate(e,t){const r=Date.now();try{if(!e||!t)return A.UNKNOWN}catch(e){return A.UNKNOWN}return r<(t-=500)?A.VALID:A.EXPIRED}}class N{constructor(e,t){this.scheme=e,this.$storage=t}get(){const e=this.scheme.options.refreshToken.prefix+this.scheme.name;return this.$storage.getUniversal(e)}set(e){const t=$(e,this.scheme.options.refreshToken.type);return this._setToken(t),this._updateExpiration(t),t}sync(){const e=this._syncToken();return this._syncExpiration(),e}reset(){this._setToken(!1),this._setExpiration(!1)}status(){return new L(this.get(),this._getExpiration())}_getExpiration(){const e=this.scheme.options.refreshToken.expirationPrefix+this.scheme.name;return this.$storage.getUniversal(e)}_setExpiration(e){const t=this.scheme.options.refreshToken.expirationPrefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncExpiration(){const e=this.scheme.options.refreshToken.expirationPrefix+this.scheme.name;return this.$storage.syncUniversal(e)}_updateExpiration(e){let t;const r=Date.now(),o=1e3*Number(this.scheme.options.refreshToken.maxAge),n=o?r+o:0;try{t=1e3*h(e+"").exp||n}catch(e){if(t=n,!e||"InvalidTokenError"!==e.name)throw e}return this._setExpiration(t||!1)}_setToken(e){const t=this.scheme.options.refreshToken.prefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncToken(){const e=this.scheme.options.refreshToken.prefix+this.scheme.name;return this.$storage.syncUniversal(e)}}class M{constructor(e,t){this.scheme=e,this.axios=t,this.interceptor=null}setHeader(e){this.scheme.options.token.global&&this.axios.setHeader(this.scheme.options.token.name,e)}clearHeader(){this.scheme.options.token.global&&this.axios.setHeader(this.scheme.options.token.name,!1)}initializeRequestInterceptor(e){this.interceptor=this.axios.interceptors.request.use((async t=>{if(!this._needToken(t)||t.url===e)return t;const{valid:r,tokenExpired:o,refreshTokenExpired:n,isRefreshable:c}=this.scheme.check(!0);let h=r;if(n)throw this.scheme.reset(),new I;if(o){if(!c)throw this.scheme.reset(),new I;h=await this.scheme.refreshTokens().then((()=>!0)).catch((()=>{throw this.scheme.reset(),new I}))}const l=this.scheme.token.get();if(!h){if(!l&&this._requestHasAuthorizationHeader(t))throw new I;return t}return this._getUpdatedRequestConfig(t,l)}))}reset(){this.axios.interceptors.request.eject(this.interceptor),this.interceptor=null}_needToken(e){const t=this.scheme.options;return t.token.global||Object.values(t.endpoints).some((t=>"object"==typeof t?t.url===e.url:t===e.url))}_getUpdatedRequestConfig(e,t){return"string"==typeof t&&(e.headers[this.scheme.options.token.name]=t),e}_requestHasAuthorizationHeader(e){return!!e.headers.common[this.scheme.options.token.name]}}class H{constructor(e,t){this.scheme=e,this.$storage=t}get(){const e=this.scheme.options.token.prefix+this.scheme.name;return this.$storage.getUniversal(e)}set(e){const t=$(e,this.scheme.options.token.type);return this._setToken(t),this._updateExpiration(t),"string"==typeof t&&this.scheme.requestHandler.setHeader(t),t}sync(){const e=this._syncToken();return this._syncExpiration(),"string"==typeof e&&this.scheme.requestHandler.setHeader(e),e}reset(){this.scheme.requestHandler.clearHeader(),this._setToken(!1),this._setExpiration(!1)}status(){return new L(this.get(),this._getExpiration())}_getExpiration(){const e=this.scheme.options.token.expirationPrefix+this.scheme.name;return this.$storage.getUniversal(e)}_setExpiration(e){const t=this.scheme.options.token.expirationPrefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncExpiration(){const e=this.scheme.options.token.expirationPrefix+this.scheme.name;return this.$storage.syncUniversal(e)}_updateExpiration(e){let t;const r=Date.now(),o=1e3*Number(this.scheme.options.token.maxAge),n=o?r+o:0;try{t=1e3*h(e+"").exp||n}catch(e){if(t=n,!e||"InvalidTokenError"!==e.name)throw e}return this._setExpiration(t||!1)}_setToken(e){const t=this.scheme.options.token.prefix+this.scheme.name;return this.$storage.setUniversal(t,e)}_syncToken(){const e=this.scheme.options.token.prefix+this.scheme.name;return this.$storage.syncUniversal(e)}}class D{constructor(e,...t){this.$auth=e,this.options=t.reduce(((p,e)=>l(p,e)),{})}get name(){return this.options.name}}const V={name:"oauth2",accessType:null,redirectUri:null,logoutRedirectUri:null,clientId:null,audience:null,grantType:null,responseMode:null,acrValues:null,autoLogout:!1,endpoints:{logout:"",authorization:"",token:"",userInfo:""},scope:[],token:{property:"access_token",type:"Bearer",name:"Authorization",maxAge:1800,global:!0,prefix:"_token.",expirationPrefix:"_token_expiration."},refreshToken:{property:"refresh_token",maxAge:2592e3,prefix:"_refresh_token.",expirationPrefix:"_refresh_token_expiration."},user:{property:!1},responseType:"token",codeChallengeMethod:"implicit"};class W extends D{constructor(e,t,...r){super(e,t,...r,V),this.req=e.ctx.req,this.token=new H(this,this.$auth.$storage),this.refreshToken=new N(this,this.$auth.$storage),this.refreshController=new P(this),this.requestHandler=new M(this,this.$auth.ctx.$axios)}get scope(){return Array.isArray(this.options.scope)?this.options.scope.join(" "):this.options.scope}get redirectURI(){const path=k((this.$auth.ctx.base||"")+"/"+this.$auth.options.redirect.callback);return this.options.redirectUri||U(o(this.req),path)}get logoutRedirectURI(){return this.options.logoutRedirectUri||U(o(this.req),this.$auth.options.redirect.logout)}check(e=!1){const t={valid:!1,tokenExpired:!1,refreshTokenExpired:!1,isRefreshable:!0},r=this.token.sync();if(this.refreshToken.sync(),!r)return t;if(!e)return t.valid=!0,t;const o=this.token.status();return this.refreshToken.status().expired()?(t.refreshTokenExpired=!0,t):o.expired()?(t.tokenExpired=!0,t):(t.valid=!0,t)}async mounted(){const{tokenExpired:e,refreshTokenExpired:t}=this.check(!0);(t||e&&this.options.autoLogout)&&this.$auth.reset(),this.requestHandler.initializeRequestInterceptor(this.options.endpoints.token);if(!await this._handleCallback())return this.$auth.fetchUserOnce()}reset(){this.$auth.setUser(!1),this.token.reset(),this.refreshToken.reset(),this.requestHandler.reset()}async login(e={}){const t={protocol:"oauth2",response_type:this.options.responseType,access_type:this.options.accessType,client_id:this.options.clientId,redirect_uri:this.redirectURI,scope:this.scope,state:e.state||E(10),code_challenge_method:this.options.codeChallengeMethod,...e.params};if(this.options.audience&&(t.audience=this.options.audience),t.response_type.includes("token")&&(t.nonce=e.nonce||E(10)),t.code_challenge_method)switch(t.code_challenge_method){case"plain":case"S256":{const e=this.generateRandomString();this.$auth.$storage.setUniversal(this.name+".pkce_state",e);const r=this.generateRandomString();this.$auth.$storage.setUniversal(this.name+".pkce_code_verifier",r);const o=await this.pkceChallengeFromVerifier(r,"S256"===t.code_challenge_method);t.code_challenge=window.encodeURIComponent(o)}}this.options.responseMode&&(t.response_mode=this.options.responseMode),this.options.acrValues&&(t.acr_values=this.options.acrValues),this.$auth.$storage.setUniversal(this.name+".state",t.state);const r=this.options.endpoints.authorization+"?"+v(t);window.location.replace(r)}logout(){if(this.options.endpoints.logout){const e={client_id:this.options.clientId+"",logout_uri:this.logoutRedirectURI},t=this.options.endpoints.logout+"?"+v(e);window.location.replace(t)}return this.$auth.reset()}async fetchUser(){if(!this.check().valid)return;if(!this.options.endpoints.userInfo)return void this.$auth.setUser({});const e=await this.$auth.requestWith(this.name,{url:this.options.endpoints.userInfo});this.$auth.setUser(w(e.data,this.options.user.property))}async _handleCallback(){if(this.$auth.options.redirect&&k(this.$auth.ctx.route.path,this.$auth.ctx)!==k(this.$auth.options.redirect.callback,this.$auth.ctx))return;const e=function(e){const t={},r=e.split("&");for(let i=0;i<r.length;i++){const e=r[i].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}return t}(this.$auth.ctx.route.hash.substr(1)),t=Object.assign({},this.$auth.ctx.route.query,e);let r,o=t[this.options.token.property];this.options.refreshToken.property&&(r=t[this.options.refreshToken.property]);const n=this.$auth.$storage.getUniversal(this.name+".state");if(this.$auth.$storage.setUniversal(this.name+".state",null),!n||t.state===n){if("code"===this.options.responseType&&t.code){let e;this.options.codeChallengeMethod&&"implicit"!==this.options.codeChallengeMethod&&(e=this.$auth.$storage.getUniversal(this.name+".pkce_code_verifier"),this.$auth.$storage.setUniversal(this.name+".pkce_code_verifier",null));const n=await this.$auth.request({method:"post",url:this.options.endpoints.token,baseURL:"",data:v({code:t.code,client_id:this.options.clientId+"",redirect_uri:this.redirectURI,response_type:this.options.responseType,audience:this.options.audience,grant_type:this.options.grantType,code_verifier:e})});o=w(n.data,this.options.token.property)||o,r=w(n.data,this.options.refreshToken.property)||r}if(o&&o.length)return this.token.set(o),r&&r.length&&this.refreshToken.set(r),this.$auth.redirect("home",!0),!0}}async refreshTokens(){const e=this.refreshToken.get();if(!e)return;if(this.refreshToken.status().expired())throw this.$auth.reset(),new I;this.requestHandler.clearHeader();const t=await this.$auth.request({method:"post",url:this.options.endpoints.token,baseURL:"",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:v({refresh_token:(r=e,o=this.options.token.type,r&&o&&"string"==typeof r?r.replace(o+" ",""):r),client_id:this.options.clientId+"",grant_type:"refresh_token"})}).catch((e=>(this.$auth.callOnError(e,{method:"refreshToken"}),Promise.reject(e))));var r,o;return this.updateTokens(t),t}updateTokens(e){const t=w(e.data,this.options.token.property),r=w(e.data,this.options.refreshToken.property);this.token.set(t),r&&this.refreshToken.set(r)}async pkceChallengeFromVerifier(e,t){if(t){const t=await this._sha256(e);return this._base64UrlEncode(t)}return e}generateRandomString(){const e=new Uint32Array(28);return window.crypto.getRandomValues(e),Array.from(e,(e=>("0"+e.toString(16)).substr(-2))).join("")}_sha256(e){const data=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",data)}_base64UrlEncode(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}}},53:function(e,t,r){"use strict";var o={name:"NoSsr",functional:!0,props:{placeholder:String,placeholderTag:{type:String,default:"div"}},render:function(e,t){var r=t.parent,o=t.slots,n=t.props,c=o(),h=c.default;void 0===h&&(h=[]);var l=c.placeholder;return r._isMounted?h:(r.$once("hook:mounted",(function(){r.$forceUpdate()})),n.placeholderTag&&(n.placeholder||l)?e(n.placeholderTag,{class:["no-ssr-placeholder"]},n.placeholder||l):h.length>0?h.map((function(){return e(!1)})):e(!1))}};e.exports=o},91:function(e,t,r){"use strict";var o=r(264);function n(e){return null!==e&&"object"===o(e)}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",o=arguments.length>3?arguments[3]:void 0;if(!n(t))return c(e,{},r,o);var h=Object.assign({},t);for(var l in e)if("__proto__"!==l&&"constructor"!==l){var d=e[l];null!==d&&(o&&o(h,l,d,r)||(Array.isArray(d)&&Array.isArray(h[l])?h[l]=h[l].concat(d):n(d)&&n(h[l])?h[l]=c(d,h[l],(r?"".concat(r,"."):"")+l.toString(),o):h[l]=d))}return h}function h(e){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return r.reduce((function(p,t){return c(p,t,"",e)}),{})}}r(70),r(10),r(88);var l=h();l.fn=h((function(e,t,r,o){if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0})),l.arrayFn=h((function(e,t,r,o){if(Array.isArray(e[t])&&"function"==typeof r)return e[t]=r(e[t]),!0})),l.extend=h,e.exports=l},93:function(e,t,r){"use strict";var o=function(e,t=!0){const r=t&&e.headers?e.headers["x-forwarded-proto"]:void 0,o="string"==typeof r?r.includes("https"):void 0;if(o)return!0;const n=e.connection?e.connection.encrypted:void 0,c=void 0!==n?!0===n:void 0;return!!c||void 0===o&&void 0===c&&void 0};const n="undefined"!=typeof location?location:{origin:"",pathname:"/"};e.exports=function(e,t){return e?encodeURI("http"+(o(e)?"s":"")+"://"+(e.headers["x-forwarded-host"]||e.headers.host)+(t?e.url:"")):n.origin+(t?n.pathname:"")}}}]);